---
title: "Machine Learning PGA MASTERS"
author: "Sam Milnes"
date: "3/27/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

pga <- read.csv("C:\\Users\\milness\\Desktop\\Machine Learning\\Final Project\\2022Masters_pred_data.csv")
pgaPast5 <- read.csv("C:\\Users\\milness\\Desktop\\Machine Learning\\Final Project\\2022Masters_past5.csv")
View(pgaPast5)
# pga <- pga[,-1]
# 
# 
# pga <- subset(pga, !is.na(pga$masters_finish))


#sub2021 <- pga[which(pga$year == 2021), ]
#View(sub2021)

# Try using clustering to see if any factors are more important

```

DEFINING COLUMN NAMES:


Top10 -> How many top 10 finishes did the player have for that given year

Wins -> How many tour wins did the player have for that given year

Score Average -> The average score the player had for given year

Rounds -> How many rounds the player played that given year

Bounce Back -> Percent of holes that scored over par immediately followed by a hole that scored less than par

Driving Accuracy -> The percentage of time a tee shot comes to rest in the fairway (regardless of club)

Driving Distance -> The average number of yards per measured drive

Gir -> (Greens in regulation) The percent of time a player was able to hit the green in regulation (greens hit in regulation/holes played)

Hole_Proximity -> The average distance the ball comes to rest from the hole (in feet) after the player's approach shot.

x_of_attempts -> 

putts_round ->  The average number of total putts per round

scramble -> Percent that shows a players ability to make par (or better) even if a Green in Regulation (GIR) is missed

sg_putt -> The number of putts a player takes from a specific distance is measured against a statistical baseline to determine the player's strokes gained or lost on a hole.

sg_t2g -> The per round average of the number of Strokes the player was better or worse than the field average on the same course & event minus the Players Strokes Gained putting value.

sg_total -> The per round average of the number of Strokes the player was better or worse than the field average on the same course & event.

sg_approach -> The number of Approach the Green strokes a player takes from specific locations and distances are measured against a statistical baseline to determine the player's strokes gained or lost on a hole

sg_tee -> The number of strokes a player takes from a specific distance off the tee on Par 4 & par 5's is measured against a statistical baseline to determine the player's strokes gained or lost off the tee on a hole

sg_ar -> The number of Around the Green strokes a player takes from specific locations and distances are measured against a statistical baseline to determine the player's strokes gained or lost on a hole

par4_sa -> The average score on all par 4's played 

par3_sa -> The average score on all par 3's played 

par5_sa -> The average score on all par 5's played 

covered_tee -> For those par 4's and par 5's where the tee shot was determined by a laser, the percentage of the hole distances that are covered by the tee shot.

left_rough -> The percentage of time a tee shot comes to rest in the left rough (regardless of club)

right_rough -> The percentage of time a tee shot comes to rest in the right rough (regardless of club)

fair_bunk -> The percentage of time a tee shot comes to rest in a fairway bunker (regardless of club)

gir_fair -> The percent of time a player was able to hit the green in regulation when the tee shot came to rest on the fairway

gir_not_fair -> The percent of time a player was not able to hit the green in regulation when the tee shot came to rest on the fairway

prox_fair -> The average distance remaining to the hole for all approach shots hit from the fairway (or the tee box on a par 3)

prox_rough -> The average distance remaining to the hole for all approach shots hit from the rough, but not around the green. The approach shot must end on or around the green or in the hole.

go_for_green -> The percent of time a player attempting to go for the green is successful. A player is assumed to be going for the green if the first shot on a par 4 or second shot on a par 5 lands on or around the green. If the second shot on a par 5 lands in the water, it is included as well

sand_save -> The percent of time a player was able to get 'up and down' once in a greenside sand bunker (regardless of score)

prox_arg -> The average distance to the hole (in feet) after hitting the ball onto the putting surface from around the green.

putt_25 ->  the percent of putts made when the ball is greater than 25 feet from the hole

putt15_25 ->  the percent of putts made when the ball is between 15 and 25 feet from the hole

putt10_15 ->  the percent of putts made when the ball is between 10 and 15 feet from the hole

putt_10 -> the percent of putts made when the ball is less than 10 feet from the hole

finround_sa -> The average number of strokes for the final round of each tournament played.

masters_finish -> the place the player finished in at that years masters. CUT means player didn't make cut.

total_score -> The players total score from that year at the masters



List of players playing in 2022 Masters
```{r}

masters2022_list = list("Abraham Ancer",
                     "Daniel Berger",
                     "Christiaan Bezuidenhout",
                     "Sam Burns",
                     "Patrick Cantlay",
                     "Paul Casey",
                     "Cameron Champ",
                     "Stewart Cink",
                     "Corey Conners",
                     "Fred Couples",
                     "Cameron Davis",
                     "Bryson DeChambeau",
                     "Harry English",
                     "Tony Finau",
                     "Matthew Fitzpatrick",
                     "Tommy Fleetwood",
                     "Sergio Garcia",
                     "Lucas Glover",
                     "Talor Gooch",
                     "Austin Greaser",
                     "Steward Hagestad",
                     "Brian Harman",
                     "Padraig Harrington",
                     "Tyrrell Hatton",
                     "Lucas Herbert",
                     "Garrick Higgo",
                     "Harry Higgs",
                     "Tom Hoge",
                     "Max Homa",
                     "Billy Horschel",
                     "Viktor Hovland",
                     "Mackenzie Hughes",
                     "Sungjae Im",
                     "Aaron Jarvis",
                     "Dustin Johnson",
                     "Zach Johnson",
                     "Takumi Kanaya",
                     "Si Woo Kim",
                     "Kevin Kisner",
                     "Brooks Koepka",
                     "Jason Kokrak",
                     "Bernhard Langer",
                     "Kyoung-Hoon Lee",
                     "Min Woo Lee",
                     "Marc Leishman",
                     "Luke List",
                     "Shane Lowry",
                     "Sandy Lyle",
                     "Robert MacIntyre",
                     "Hideki Matsuyama",
                     "Rory McIlroy",
                     "Guido Migliozzi",
                     "Larry Mize",
                     "Francesco Molinari",
                     "Collin Morikawa",
                     "Kevin Na",
                     "Keita Nakajima",
                     "Joaquin Niemann",
                     "Jose Mario Olazabal",
                     "Louis Oosthuizen",
                     "Ryan Palmer",
                     "James Piot",
                     "Jon Rahm",
                     "Patrick Reed",
                     "Justin Rose",
                     "Xander Schauffele",
                     "Scottie Scheffler",
                     "Charl Schwartzel",
                     "Adam Scott",
                     "Laird Shepherd",
                     "Webb Simpson",
                     "Vijay Singh",
                     "Camerson Smith",
                     "Jordon Spieth",
                     "Sepp Straka",
                     "Hudson Swafford",
                     "Justin Thomas",
                     "Erik van Rooyen",
                     "Bubba Watson",
                     "Mike Weir",
                     "Lee Westwood",
                     "Danny Willet",
                     "Matthew Wolff",
                     "Gary Woodland",
                     "Tiger Woods",
                     "Will Zalatoris")
```

Filter data to only players playing in Masters this year.
```{r}
library(dplyr)    

current_masters <- filter(pga, player_name %in% masters2022_list)

current_masters <- current_masters[, -1]
#View(current_masters)

```

Filter data to see stats from 2005 - 2021
```{r}

current_masters_0518_stats <- current_masters[which(current_masters$year <= 2019),]
View(current_masters_0518_stats)

```


Things to do:
- Clean Data:
  - Get rid of T in front of numbers in masters finish column
  - Get rid of x_attempts column and hole proximity
  - Clean score average column, fill in blanks with the median of all score         averages
  - Clean holes column, fill in blanks with median of all holes
  - clean gir_fair column, fill with median
  - Change columns with ft as units to inches
  - Fill in putting averages
  - Fix scraper to pull in 2022 stats
  
  
Cleaning Data  
```{r}
current_masters$masters_finish<-gsub("T","",as.character(current_masters$masters_finish))

current_masters
```




This is all the current players stats who have played in 2022 and will be
competing in the masters this year. There is also some players playing that are
not in this list because they are playing in the masters but haven't played in 
2022 season yet[etc.. tiger woods, Bryson Dechambeau]. We are going to predict 
the top 10 players from this dataset.
```{r}

data <- read.csv("C:\\Users\\milness\\Desktop\\Machine Learning\\Final Project\\2022FinalMasters_pred_data.csv")
#View(data)

predict_2022_masters <- filter(data, player_name %in% masters2022_list)

```


Clean Masters 2022 Data for prediction
```{r}

# Geting rid of T in front of some ranks
predict_2022_masters$ranking<-gsub("T","",as.character(predict_2022_masters$ranking))

# Get rid of x_attempts and hole proximity column
predict_2022_masters <- subset(predict_2022_masters,
                               select = -c(hole_proximity, x_of_attempts))


# Change columns with ft as units to inches
mat_fair <- stringr::str_extract_all(predict_2022_masters$prox_fair, "\\d+", simplify = TRUE)
predict_2022_masters$prox_fair <- as.numeric(mat_fair[, 1]) * 12 + as.numeric(mat_fair[, 2])
mat_rough <- stringr::str_extract_all(predict_2022_masters$prox_rough, "\\d+", simplify = TRUE)
predict_2022_masters$prox_rough <- as.numeric(mat_rough[, 1]) * 12 + as.numeric(mat_rough[, 2])
mat_arg <- stringr::str_extract_all(predict_2022_masters$prox_arg, "\\d+", simplify = TRUE)
predict_2022_masters$prox_arg <- as.numeric(mat_arg[, 1]) * 12 + as.numeric(mat_arg[, 2])


#View(predict_2022_masters)

```


Technique Ideas:

- Logistic Regression to get probability of winning
- linear regression to predict total score for weekend
  - We are going to try to predict the final score response variable. To
  predict for this year, we will pass in all the players data up until the
  tournament.


Create Training/Test Data:
Clean up original data frame with all players from 2005:2019.
  - use that data as test data to predict masters score
create subset of 2021 data
  - Use this as test data to calculate error rate etc....
  


